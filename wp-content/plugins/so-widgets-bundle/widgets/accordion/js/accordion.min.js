var sowb=window.sowb||{};jQuery(function(p){sowb.setupAccordion=function(){p(".sow-accordion").each(function(o,n){var e=p(this).closest(".so-widget-sow-accordion");if(e.data("initialized"))return p(this);var a=e.data("useAnchorTags"),i=e.data("initialScrollPanel"),c=p(n).find("> .sow-accordion-panel");c.not(".sow-accordion-panel-open").find(".sow-accordion-panel-content").hide();var s=c.filter(".sow-accordion-panel-open").toArray(),t=function(){},r=function(o,n){var a=p(o);if(!a.is(".sow-accordion-panel-open")){a.find("> .sow-accordion-panel-content").slideDown(function(){p(this).trigger("show"),p(sowb).trigger("setup_widgets")}),a.addClass("sow-accordion-panel-open"),s.push(o);var i=p(o).parents(".sow-accordion-panel");i.length&&!i.hasClass("sow-accordion-panel-open")&&r(i.get(0),!0),n||t()}},d=function(o,n){var a=p(o);a.is(".sow-accordion-panel-open")&&(a.find("> .sow-accordion-panel-content").slideUp(function(){p(this).trigger("hide")}),a.removeClass("sow-accordion-panel-open"),s.splice(s.indexOf(o),1),n||t())};if(c.find("> .sow-accordion-panel-header").click(function(){var o=p(this),a=e.data("maxOpenPanels"),n=o.closest(".sow-accordion-panel");if(n.is(".sow-accordion-panel-open")?d(n.get(0)):r(n.get(0)),!isNaN(a)&&0<a&&s.length>a){var i=0;p.each(s.reverse(),function(o,n){i!==a?i++:d(s[o])})}}),a){t=function(){for(var o=[],n=p(".sow-accordion-panel-open").toArray(),a=0;a<n.length;a++){var i=p(n[a]).data("anchor");if(i){var e=p(n[a]).parents(".sow-accordion-panel");(!e.length||e.length&&e.hasClass("sow-accordion-panel-open"))&&(o[a]=i)}}o&&o.length?window.location.hash=o.join(","):window.history.pushState("",document.title,window.location.pathname+window.location.search)};var w=function(){for(var o=c.toArray(),n=0;n<o.length;n++){var a=o[n],i=p(a).data("anchor");i&&-1<window.location.hash.indexOf(i)?r(a,!0):d(a,!0)}};if(p(window).on("hashchange",w),window.location.hash?w():t(),0<i){var l=i>c.length?c.last():c.eq(i-1);window.scrollTo(0,l.offset().top-90)}}e.data("initialized",!0)})},sowb.setupAccordion(),p(sowb).on("setup_widgets",sowb.setupAccordion)}),window.sowb=sowb;